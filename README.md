# Vytsja - –ë—é–¥–∂–µ—Ç–Ω–∏–π –ö–æ–Ω—Ç—Ä–æ–ª—å

Google Apps Script –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –æ–±–ª—ñ–∫—É –≤ Google Sheets –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó –º–æ–≤–∏ —Ç–∞ —á–µ—Å—å–∫–æ—ó –≤–∞–ª—é—Ç–∏ (CZK).

## –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

### buildBudget()
–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ —Å—Ç–≤–æ—Ä—é—î –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π –±—é–¥–∂–µ—Ç–Ω–∏–π –ª–∏—Å—Ç –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –º–æ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏:

#### üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—Å—Ç–∞ "–ë—é–¥–∂–µ—Ç"

1. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (A1:F10)**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–µ—Ä—ñ–æ–¥—É (–ø–æ—Ç–æ—á–Ω–∏–π –º—ñ—Å—è—Ü—å)
   - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∞–ª—é—Ç–∏ (CZK)
   - –†–µ–∑–µ—Ä–≤ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Ç–∞ —Ü—ñ–ª—å–æ–≤–∏–π

2. **üü¢ –î–æ—Ö–æ–¥–∏ (A12:F18)**
   - –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó: –ó–∞—Ä–ø–ª–∞—Ç–∞/–ß–∞–π–æ–≤—ñ, –ü—ñ–¥—Ä–æ–±—ñ—Ç–æ–∫, –í—ñ–¥ —Å—ñ–º'—ó, –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –±–æ—Ä–≥—ñ–≤, –Ü–Ω—à—ñ –¥–∂–µ—Ä–µ–ª–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫: –ü–ª–∞–Ω, –§–∞–∫—Ç, –í—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è, %, –°—Ç–∞—Ç—É—Å

3. **üî¥ –í–∏—Ç—Ä–∞—Ç–∏ (A20:F32)**
   - 11 –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –≤–∏—Ç—Ä–∞—Ç: –û—Ä–µ–Ω–¥–∞, –ö–æ–º—É–Ω–∞–ª—å–Ω—ñ, –á–∂–∞, –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –î–∏—Ç–∏–Ω–∞, –¢–µ–ª–µ—Ñ–æ–Ω, –ö—É—Ä—ñ–ª–∫–∏, –û—Å–æ–±–∏—Å—Ç—ñ, –ë–æ—Ä–≥–∏, –ù–µ–ø–µ—Ä–µ–¥–±–∞—á–µ–Ω—ñ, –Ü–Ω—à–µ
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è–º –ø–µ—Ä–µ–≤–∏—Ç—Ä–∞—Ç

4. **üìù –ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π (A34:I200)**
   - –ü–æ–ª—è: –î–∞—Ç–∞, –¢–∏–ø, –ê–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä—ñ—è, –°—É–º–∞, –û–ø–∏—Å, –û–ø–ª–∞—Ç–∞, –ë–∞–ª–∞–Ω—Å, NET –¥–µ–Ω—å, NET –∫—É–º—É–ª.
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü—ñ—è –∑–∞ –æ–ø–∏—Å–æ–º
   - –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Ç–∞ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è
   - –§—ñ–∫—Å–∞—Ü—ñ—è –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤

5. **üìä –ü—ñ–¥—Å—É–º–∫–∏ (A202:E210)**
   - –ó–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥
   - –ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏
   - –ß–∏—Å—Ç–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   - –†–µ–∑–µ—Ä–≤ –ø–æ—Ç–æ—á–Ω–∏–π
   - –î–æ —Ü—ñ–ª—ñ —Ä–µ–∑–µ—Ä–≤—É

### CATEGORYZE(desc, amount)
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü—ñ—ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –Ω–∞ –æ—Å–Ω–æ–≤—ñ:
- –ö–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤ –≤ –æ–ø–∏—Å—ñ (—Ç–µ–∫—Å—Ç—É)
- –°—É–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
- –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö –º–∞–≥–∞–∑–∏–Ω—ñ–≤ —Ç–∞ –ø–æ—Å–ª—É–≥

**–ü—Ä–∏–∫–ª–∞–¥–∏ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è:**
- "–æ—Ä–µ–Ω–¥–∞" –∞–±–æ "rent" + —Å—É–º–∞ > 15000 ‚Üí üè† –û—Ä–µ–Ω–¥–∞
- "tesco", "albert", "billa", "lidl", "penny" ‚Üí üçï –á–∂–∞
- "—Ç–µ–ª–µ—Ñ–æ–Ω", "o2", "vodafone" + 200-800 CZK ‚Üí üì± –¢–µ–ª–µ—Ñ–æ–Ω/–ó–≤'—è–∑–æ–∫
- "—Å–∞–¥–æ–∫", "≈°kolka", "kindergarten" ‚Üí üë∂ –î–∏—Ç–∏–Ω–∞
- –Ü–Ω—à–µ ‚Üí üõí –Ü–Ω—à–µ

## –¢–µ—Ö–Ω—ñ—á–Ω—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

### –Ü–º–µ–Ω–æ–≤–∞–Ω—ñ –¥—ñ–∞–ø–∞–∑–æ–Ω–∏
- `TR_DATE`, `TR_TYPE`, `TR_CAT`, `TR_AMOUNT`, `TR_DESC`, `TR_PAY`, `TR_BAL`, `TR_NET_DAY`, `TR_NET_CUM`
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —É —Ñ–æ—Ä–º—É–ª–∞—Ö SUMIFS –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ö –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—ñ–≤

### –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö
- **–¢–∏–ø —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó**: –î–æ—Ö—ñ–¥/–í–∏—Ç—Ä–∞—Ç–∞ (–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)
- **–û–ø–ª–∞—Ç–∞**: –ì–æ—Ç—ñ–≤–∫–∞/–ö–∞—Ä—Ç–∫–∞/–ó–º—ñ—à–∞–Ω–æ
- **–°—É–º–∞**: –¢—ñ–ª—å–∫–∏ —á–∏—Å–ª–∞ > 0
- **–î–∞—Ç–∞**: –§–æ—Ä–º–∞—Ç yyyy-mm-dd

### –£–º–æ–≤–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
- ‚úÖ –î–æ—Ö–æ–¥–∏ >= 90% –ø–ª–∞–Ω—É ‚Üí –∑–µ–ª–µ–Ω–∏–π —Ç–µ–∫—Å—Ç
- ‚ö†Ô∏è –í–∏—Ç—Ä–∞—Ç–∏ > 120% –ø–ª–∞–Ω—É ‚Üí —á–µ—Ä–≤–æ–Ω–∞ –∑–∞–ª–∏–≤–∫–∞
- üí∞ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó > 10,000 CZK ‚Üí –∂–æ–≤—Ç–∞ –∑–∞–ª–∏–≤–∫–∞

### –§–æ—Ä–º–∞—Ç–∏
- **–í–∞–ª—é—Ç–∞**: CZK –±–µ–∑ –∫–æ–ø—ñ–π–æ–∫ ([CZK] #,##0)
- **–õ–æ–∫–∞–ª—å**: en_US (–∫–æ–º–∏ –≤ —Ñ–æ—Ä–º—É–ª–∞—Ö)
- **–ß–∞—Å–æ–≤–∏–π –ø–æ—è—Å**: Europe/Prague
- **–î–∞—Ç–∞**: yyyy-mm-dd

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Google Sheets
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ **–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è** ‚Üí **Apps Script**
3. –°–∫–æ–ø—ñ—é–π—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `Code.gs`
4. –ó–±–µ—Ä–µ–∂—ñ—Ç—å –ø—Ä–æ–µ–∫—Ç
5. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é `buildBudget()`

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
```javascript
buildBudget()
```

–¶–µ —Å—Ç–≤–æ—Ä–∏—Ç—å –Ω–æ–≤–∏–π –ª–∏—Å—Ç "–ë—é–¥–∂–µ—Ç" –∑ —É—Å—ñ–º–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏.

### –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ —Å–µ–∫—Ü—ñ—ó "üìù –ñ–£–†–ù–ê–õ –¢–†–ê–ù–ó–ê–ö–¶–Ü–ô" (—Ä—è–¥–æ–∫ 36+)
2. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å:
   - **–î–∞—Ç–∞**: —É —Ñ–æ—Ä–º–∞—Ç—ñ yyyy-mm-dd
   - **–¢–∏–ø**: –î–æ—Ö—ñ–¥ –∞–±–æ –í–∏—Ç—Ä–∞—Ç–∞
   - **–°—É–º–∞**: –ø–æ–∑–∏—Ç–∏–≤–Ω–µ —á–∏—Å–ª–æ
   - **–û–ø–∏—Å**: —Ç–µ–∫—Å—Ç–æ–≤–∏–π –æ–ø–∏—Å
   - **–û–ø–ª–∞—Ç–∞**: –ì–æ—Ç—ñ–≤–∫–∞/–ö–∞—Ä—Ç–∫–∞/–ó–º—ñ—à–∞–Ω–æ
3. **–ê–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä—ñ—è** –≤–∏–∑–Ω–∞—á–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
4. **–ë–∞–ª–∞–Ω—Å** —Ç–∞ **NET** —Ä–æ–∑—Ä–∞—Ö—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–ª–∞–Ω—É
1. –£ —Å–µ–∫—Ü—ñ—ó "üü¢ –î–û–•–û–î–ò" –∑–∞–ø–æ–≤–Ω—ñ—Ç—å —Å—Ç–æ–≤–ø–µ—Ü—å "–ü–ª–∞–Ω" (B14:B18)
2. –£ —Å–µ–∫—Ü—ñ—ó "üî¥ –í–ò–¢–†–ê–¢–ò" –∑–∞–ø–æ–≤–Ω—ñ—Ç—å —Å—Ç–æ–≤–ø–µ—Ü—å "–ü–ª–∞–Ω" (B22:B32)
3. –°—Ç–∞—Ç—É—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±—É–¥–µ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ

## –§–æ—Ä–º—É–ª–∏ —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ñ–∞–∫—Ç—É
```javascript
=SUMIFS(TR_AMOUNT,TR_TYPE,"–î–æ—Ö—ñ–¥",TR_CAT,$A14)
```

### –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É
- –î–æ—Ö–æ–¥–∏: ‚úÖ —è–∫—â–æ >= 90%, —ñ–Ω–∞–∫—à–µ ‚ö†Ô∏è
- –í–∏—Ç—Ä–∞—Ç–∏: ‚úÖ —è–∫—â–æ <= 100%, —ñ–Ω–∞–∫—à–µ ‚ö†Ô∏è

### –ë–∞–ª–∞–Ω—Å
```javascript
=IF($B36="–î–æ—Ö—ñ–¥",G35+$D36,G35-$D36)
```

### NET –∑–∞ –¥–µ–Ω—å
```javascript
=SUMIFS(TR_AMOUNT,TR_DATE,$A36,TR_TYPE,"–î–æ—Ö—ñ–¥")-SUMIFS(TR_AMOUNT,TR_DATE,$A36,TR_TYPE,"–í–∏—Ç—Ä–∞—Ç–∞")
```

## –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

- –õ–æ–∫–∞–ª—å: –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
- –í–∞–ª—é—Ç–∞: –ß–µ—Å—å–∫–∞ –∫—Ä–æ–Ω–∞ (CZK)
- –ß–∞—Å–æ–≤–∏–π –ø–æ—è—Å: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—î–≤—Ä–æ–ø–µ–π—Å—å–∫–∏–π (Prague)
- –§–æ—Ä–º–∞—Ç –¥–∞—Ç–∏: ISO 8601 (yyyy-mm-dd)

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

–í—ñ–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –¥–ª—è –æ—Å–æ–±–∏—Å—Ç–∏—Ö –ø–æ—Ç—Ä–µ–±.
